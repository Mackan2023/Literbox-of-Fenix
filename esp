#include <Arduino.h>
#include <ESP8266WiFi.h>
#include <ESPAsyncWebServer.h>
#include <string.h>
#include <stdio.h>
#include "sha256.h" // Exempel på en SHA-256-bibliotek

const char* ssid = "admin";
const char* password = "lösenordet";

AsyncWebServer server(80);

// Ta emot fil från HTML-filen
void handleUpload(AsyncWebServerRequest* request, String filename, size_t index, uint8_t* data, size_t len, bool final) {
    // Skriv filen till SPIFFS eller annat lagringsutrymme
    // Implementera din kod här
}

// Ta emot hash och fil från HTML-filen
void handleUpdate(AsyncWebServerRequest* request) {
    // Ta emot hash och fil från HTML-filen
    // Skicka hash och fil till STM32
    // Implementera din kod här
}

void setup() {
    Serial.begin(115200);
    WiFi.begin(ssid, password);
    while (WiFi.status() != WL_CONNECTED) {
        delay(1000);
        Serial.println("Ansluter till WiFi...");
    }
    Serial.println("Ansluten till WiFi!");

    server.on("/upload", HTTP_POST, [](AsyncWebServerRequest* request) {
        request->send(200);
    }, handleUpload);
    
    server.on("/update", HTTP_POST, handleUpdate);
    server.begin();
}

void loop() {
    // Din övriga kod här
}
